!function(t,e){"use strict";e.Plugin.StateTransition=function(t,i){e.Plugin.call(this,t,i),this.settings={duration:.3*e.Timer.SECOND,ease:e.Easing.Exponential.InOut,properties:{alpha:0}},this._originalStateMethods={}},e.Plugin.StateTransition.prototype=Object.create(e.Plugin.prototype),e.Plugin.StateTransition.prototype.constructor=e.Plugin.StateTransition,e.Plugin.StateTransition.prototype.configure=function(t){var e;if(!t)return Object.create(this.settings);for(e in t)this.settings[e]&&(this.settings[e]=t[e])},e.Plugin.StateTransition.prototype.to=function(){var t,i,s=arguments[0],a=this;if(!s)throw"No state passed.";this._destroy(),this.game.paused=!0,this._texture=new e.RenderTexture(this.game,this.game.width,this.game.height,"cover"),this._texture.renderXY(this.game.world,-this.game.camera.x,-this.game.camera.y),this._originalStateMethods[s]=this._originalStateMethods[s]||{init:this.game.state.states[s].init,create:this.game.state.states[s].create},t=this._originalStateMethods[s].init,i=this._originalStateMethods[s].create,this.game.state.states[s].init=function(){this.game.add.existing(a._newCover()),t&&t.apply(this,arguments)},this.game.state.states[s].create=function(){i&&i.apply(this,arguments),a.bringToTop(),a._animateCover()},this.game.paused=!1,this.game.state.start.apply(this.game.state,arguments)},e.Plugin.StateTransition.prototype._newCover=function(){return this._cover=new e.Sprite(this.game,0,0,this._texture),this._cover.fixedToCamera=!0,this._cover.anchor.set(.5),this._cover.cameraOffset.x=this.game.width/2,this._cover.cameraOffset.y=this.game.height/2,this._cover},e.Plugin.StateTransition.prototype.bringToTop=function(){this._cover&&this._cover.bringToTop()},e.Plugin.StateTransition.prototype._animateCover=function(){var t,e,i;for(e in this.settings.properties)"object"==typeof this.settings.properties[e]?i=this.game.add.tween(this._cover[e]).to(this.settings.properties[e],this.settings.duration,this.settings.ease,!0):(t={},t[e]=this.settings.properties[e],i=this.game.add.tween(this._cover).to(t,this.settings.duration,this.settings.ease,!0));i.onComplete.addOnce(this._destroy,this)},e.Plugin.StateTransition.prototype._destroy=function(){this._cover&&this._cover.destroy(),this._texture&&this._texture.destroy()}}(window,Phaser);